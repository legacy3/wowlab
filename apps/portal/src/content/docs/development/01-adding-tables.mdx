---
title: Adding DBC Tables
description: How to add new game data tables to Supabase
---

# Adding DBC Tables

Game data lives in Supabase under the `game` schema. Raw DBC data is stored in `raw_dbc` and transformed views/tables are exposed via `game`.

Most contributors don't need to add tables. The existing tables cover spells, items, talents, and other common data.

## Overview

Adding a new DBC table involves:

1. Creating a Supabase migration for the raw table
2. Creating a view or transformed table in the `game` schema
3. Regenerating TypeScript types
4. Adding React Query hooks if needed

## 1. Create the migration

Use the Supabase MCP tool to apply migrations directly:

```sql
-- Raw DBC table (matches CSV structure)
create table raw_dbc.my_new_table (
  "ID" integer primary key,
  "Name_lang" text,
  "SomeFK" integer
  -- ... match columns from the CSV exactly
);

-- Optional: create a view in the game schema
create view game.my_new_table as
select
  "ID" as id,
  "Name_lang" as name,
  "SomeFK" as some_fk
from raw_dbc.my_new_table;
```

Use `mcp__supabase__apply_migration` to apply the SQL.

## 2. Generate TypeScript types

Regenerate the database types using `mcp__supabase__generate_typescript_types` and save the output to `apps/portal/src/lib/supabase/database.types.ts`.

## 3. Add React Query hooks (optional)

If you need to query the table from the portal, add hooks in `apps/portal/src/lib/state/game.ts`:

```typescript
export function useMyNewTable(id: number | null | undefined) {
  const supabase = createClient();

  return useQuery({
    enabled: id != null,
    queryFn: async () => {
      const { data, error } = await supabase
        .schema("game")
        .from("my_new_table")
        .select("*")
        .eq("id", id!)
        .single();
      if (error) throw error;
      return data;
    },
    queryKey: ["game", "my-new-table", id],
  });
}
```

## Existing tables

Common tables already available in the `game` schema:

| Table            | Description                     |
| ---------------- | ------------------------------- |
| `spells`         | Spell data with computed fields |
| `items`          | Item data with stats            |
| `auras`          | Aura/buff information           |
| `classes`        | Player classes                  |
| `specs`          | Specializations                 |
| `global_colors`  | UI color definitions            |
| `global_strings` | Localized UI strings            |

Query these directly via Supabase client or use the existing hooks in `apps/portal/src/lib/state/game.ts`.
